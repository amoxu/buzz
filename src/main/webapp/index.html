<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>乐热评-因为热爱所以快乐</title>
    <link rel="stylesheet" href="layui/css/layui.css">
    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" type="text/css" href="./alicon/iconfont.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/comment.css">
    <style>

        .topic-column {
            width: 100%;
            text-align: center;
            -moz-box-shadow: 0 -4px 4px -4px rgba(0, 0, 0, 0.37);
            box-shadow: 0 -4px 4px -4px rgba(0, 0, 0, 0.37);
        }

        .topic-column ul {
            display: inline-block;
            width: auto;
            margin: auto;
            padding: 0;

        }

        .topic-column ul div {
            position: absolute;
            bottom: 0;
            right: 0;
            left: 0;
            color: #fff;
            font-size: 14px;
            height: auto;
            overflow: hidden;
        }

        .topic-column ul span {
            height: auto;
            padding: 0 5px 10px;
            display: block;
            line-height: 1.4;
            text-overflow: ellipsis;
            overflow: hidden;
        }

        .topic-column ul li {
            position: relative;
            overflow: hidden;

            width: 120px;
            height: 120px;
            margin: 15px 25px;
            display: block;
            float: left;
            -webkit-border-radius: 10px;
            -moz-border-radius: 10px;
            border-radius: 10px;
            cursor: pointer;

            line-height: 75px;
            text-align: center;
            background-repeat: no-repeat;
            background-position: center;
        }

        .topic-column ul li img {
            vertical-align: middle;
        }

        .topic-column li:nth-child(1) {
            background-color: #1ABC9C;
        }

        .topic-column li:nth-child(2) {
            background-color: #34495E;
        }

        .topic-column li:nth-child(3) {
            background-color: #F39C12;
        }


    </style>
</head>
<body class="mbg">

<!-- 你的HTML代码 -->
<div class="layui-header header header-doc ">
    <div class="layui-main pbg">
        <a class="logo" href="./index.html"><img src="img/logo.png"/>
        </a>
        <ul class="layui-nav layui-layout-left" lay-filter="">
            <li class="layui-nav-item layui-this"><a href="./index.html">首页</a></li>
            <li class="layui-nav-item"><a href="./search.html">搜索</a></li>

            <li class="layui-nav-item"><a href="./events.html">动态</a></li>
            <li class="layui-nav-item layui-layout-right">
            </li>
        </ul>
    </div>
    <!--[if lt IE 9]>
    <script src="https://cdn.staticfile.org/html5shiv/r29/html5.min.js"></script>
    <script src="https://cdn.staticfile.org/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</div>


<div class="layui-main pbg">


    <div class="layui-carousel" id="carousel">
        <div carousel-item>
            <div>条目1</div>
            <div>条目2</div>
            <div>条目3</div>
            <div>条目4</div>
            <div>条目5</div>
        </div>
    </div>
    <div class="layui-row">

        <ul class=" icon_lists  clear">
            <div class="layui-col-md2 layui-col-lg-offset2">

                <li>
                    <a href="./recommend.html">
                        <i class="icon iconfont icon-tuijiandianpu" style="color: #FF8240"></i>
                    </a>
                    <div class="name">推荐</div>
                </li>
            </div>
            <div class="layui-col-md2 ">
                <li>
                    <a href="./buzz.html">
                        <i class="icon iconfont icon-pinglun" style="color: #FF5900"></i>
                    </a>
                    <div class="name">评论</div>
                </li>
            </div>
            <div class="layui-col-md2">

                <li>
                    <a href="./music.html">
                        <i class="icon iconfont icon-yinle" style="color: #BF6230"></i>
                    </a>
                    <div class="name">音乐分享</div>
                </li>
            </div>

            <div class="layui-col-md2">

                <li>
                    <a href="./topic.html">
                        <i class="icon iconfont icon-huati" style="color: #BF6230"></i>
                    </a>
                    <div class="name">话题</div>
                </li>
            </div>
        </ul>
    </div>
    <hr>

    <div class="layui-row">
        <div class="layui-col-md9">
            <div data-id="user-like">
            </div>

            <div style="text-align: center;font-size: x-large">...</div>

            <!--推荐歌曲-->

            <div data-id="music"></div>
            <div class="topic-column">
                <ul>
                    <li>
                        <img src="img/audio.svg" width="40" alt="">
                        <a data-name="0">
                            <div><span></span></div>
                        </a>
                    </li>
                    <li>
                        <img src="img/hearts.svg" width="80" alt="">
                        <a data-name="1">
                        <div><span></span></div>
                        </a>
                    </li>
                    <li>
                        <img src="img/earphone.svg" width="60" alt="">
                        <a data-name="2">
                        <div><span></span></div>
                        </a>
                    </li>

                    <div style="clear: both"></div>
                </ul>
                <div style="clear: both"></div>
            </div>
            <div data-id="topic"></div>
            <hr>
        </div>

        <div class="layui-col-md3">
            <div class="layui-box ">
                <div class="ws18 up25">活动</div>
                <hr>
                <ul>
                    <div class="layui-show-lg-inline-block">
                        <li><a>活动1..............</a></li>
                        <li><a>活动2..............</a></li>
                        <li><a>活动3..............</a></li>
                    </div>
                </ul>
                <hr>
            </div>
            <div class="layui-box">
                <div class="ws18">附近</div>
                <hr>
                <ul class="nearby"></ul>
                <hr>
            </div>
        </div>


    </div>
    <div class="footer">
        &copy;Copyright 2018 乐热评<br>
        感谢：<a>Layui</a>,<a>Bootstrap</a>,<a>网易云</a>,<a>QQ音乐</a>,<a>酷我音乐</a>...<br>
        联系我们：<a href="mailto:amoxuk@aliyun.com">amoxuk#aliyun.com(#换成@)</a>
    </div>


</div>
<script src="layui/layui.js"></script>
<script type="text/javascript" src="js/jquery-1.12.0.min.js"></script>
<script src="js/jquery.session.js"></script>
<script type="text/javascript" src="js/jquery.flexText.js"></script>
<script src="js/common.js"></script>
<script src="js/top.js"></script>

<script>

    layui.use(['carousel', 'layer'], function () {
        var carousel = layui.carousel;
        //建造实例
        carousel.render({
            elem: '#carousel'
            , width: '100%' //设置容器宽度
            , height: 200 //设置容器宽度
            , arrow: 'hover' //始终显示箭头
        });
    });
    $.get('/index/buzz', function (result) {
        var tmp = "";
        $.each(result.data, function (idx, result) {

            tmp += '<li class="card clearfix">' +
                '<div class="card_detail" style="margin-left: 17px">' +
                '<div class="card_nick">' +
                '<a href="http://music.163.com/#/user/home?id=' + result.userId + '" target="_blank" class="ws16 W_fb S_txt1">' + result.userName + '</a>' +
                '</div>' +
                '<div class="float_right">' +
                '<a href="javascript:void(0);" id="push-like" data-id=""><i class="iconfont" style="font-size: x-large;margin-left: 1em; color: #FF5900"></i></a>' +
                '<a href="javascript:void(0);" id="push-dislike" data-id=""><i class="iconfont" style="font-size: x-large;margin-left: 1em; color: #2D93CA"></i></a>' +
                '</div>' +
                '<div class="card_time">' + result.ctime + '</div>' +
                '<div class="card_text ws14">' + result.content + '</div>';
            if (result.bereplied) {
                tmp += '<div class="card_text ws14"> <strong>回复消息</strong>：' + result.bereplied + '</div>';
            }
            tmp += '<div class="float_right">——来自 <a target="_blank" href="http://music.163.com/#/artist?id='
                + result.music.sid + '">' + result.music.singer.name +
                '</a> 《<a target="_blank"  href="' + result.music.link + '">' +
                result.music.name + '</a>》 <a>' + result.music.source.name + '</a></div>' +
                '<div class="layui-row">' +
                '<ul class="inline">' +
                '<li class="like" data-id="' + result.id + '">' +
                '<a href="javascript:;" >';

            if (result.userLike) {
                tmp += '<i class="iconfont icon-dianzan1"></i>';
            } else {
                tmp += '<i class="iconfont icon-dianzan"></i>';
            }
            tmp += '<num>' + result.likedNum + '</num>' +
                '</a>' +
                '</li>' +
                '<li class="comment" data-id="' + result.id + '">' +
                '<a href="javascript:;" ><i class="layui-icon">&#xe63a;</i>' +
                '</a>' +
                '</li>' +
                '<li class="share" data-id="' + result.id + '">' +
                '<a href="javascript:;" ><i class="layui-icon">&#xe641;</i></a>' +
                '</li>' +
                '<li class="report" data-id="' + result.id + '">' +
                '<a href="javascript:;" ><i class="layui-icon">&#xe6c5;</i></a>' +
                '</li>' +
                '</ul>' +
                '<div class="commentAll">' +
                '<div class="reviewArea clearfix"></div>' +
                '<div class="comment-show">';
            if (result.comment.length > 0) {
                var child = buildReply(result.comment);
                tmp += '<ul class="hf-list-con" style="display: block;">' + child + '</ul>';
            } else {
                tmp += '<ul class="hf-list-con"></ul>';
            }
            tmp +=
                '</div>' +
                '</div>' +
                '<div class="comment-pl-block clearfix">' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</li>';
        });
        $('div[data-id="user-like"]').html(tmp);

    });
    $.get('/index/music', function (result) {
        var tmp = "";
        $.each(result.data, function (idx, result) {
            tmp += '<li class="card clearfix">' +
                '<div class="float_left">' +
                '<img src=' + result.sendUser.icons + ' class="head"/>' +
                '</div>' +
                '<div class="card_detail">' +
                '<div class="card_nick">' +
                '<a href="javascript:;" target="_blank" class="W_f14 W_fb S_txt1">' + result.sendUser.nickname + '</a>' +
                '</div>' +
                '<div class="card_time">' + result.ctime + '</div>' +
                '<i class="layui-icon layui-icon-headset" style="color: #1E9FFF;"></i>   <a>' + result.music.singer.name + '</a> 的<a  target="_blank" href="' + result.music.link +
                '" data-id="' + result.music.mid + '">《' + result.music.name +
                '》</a> 来自 <a>' + result.music.source.name + '</a>' +
                '<div class="card_text ws14">' + result.content + '</div>' +
                '<div class="layui-row">' +
                '<ul class="inline">' +
                '<li class="like" data-id="' + result.oid + '">' +
                '<a href="javascript:;" >';

            if (result.userLike) {
                tmp += '<i class="iconfont icon-dianzan1"></i>';
            } else {
                tmp += '<i class="iconfont icon-dianzan"></i>';
            }
            tmp += '<num>' + result.likes + '</num>' +
                '</a>' +
                '</li>' +
                '<li class="comment" data-id="' + result.oid + '">' +
                '<a href="javascript:;" ><i class="layui-icon">&#xe63a;</i>' +
                '</a>' +
                '</li>' +
                '<li class="share" data-id="' + result.oid + '">' +
                '<a href="javascript:;" ><i class="layui-icon">&#xe641;</i></a>' +
                '</li>' +
                '<li class="report" data-id="' + result.oid + '">' +
                '<a href="javascript:;" ><i class="layui-icon">&#xe6c5;</i></a>' +
                '</li>' +
                '</ul>' +
                '<div class="commentAll">' +
                '<div class="reviewArea clearfix"></div>' +
                '<div class="comment-show">';
            if (result.comment.length > 0) {
                var child = buildReply(result.comment);
                tmp += '<ul class="hf-list-con" style="display: block;">' + child + '</ul>';
            } else {
                tmp += '<ul class="hf-list-con"></ul>';
            }
            tmp +=
                '</div>' +
                '</div>' +
                '<div class="comment-pl-block clearfix">' +
                '</div>' +
                '</div>' +
                '</div>' +
                '</li>';
        })

        $('div[data-id="music"]').html(tmp);

    });
    $.get('/index/topic', function (result) {
        var tmp = "";
        $.each(result.data, function (idx, result) {
            {
                tmp += '<li class="card clearfix">' +
                    '<div class="float_left">' +
                    '<img src=' + result.sendUser.icons + ' class="head"/>' +
                    '</div>' +
                    '<div class="card_detail">' +
                    '<div class="card_nick">' +
                    '<a href="javascript:;" target="_blank" class="W_f14 W_fb S_txt1">' + result.sendUser.nickname + '</a>' +
                    '</div>' +
                    '<div class="card_time">' + result.ctime + '</div>' +
                    '<a href="javascript:;" class="topic" data-id="' + result.ttid + '">#' + result.topic + '#</a>' +
                    '<div class="card_text ws14">' + result.content + '</div>' +
                    '<div class="layui-row">' +
                    '<ul class="inline">' +
                    '<li class="like" data-id="' + result.cid + '">' +
                    '<a href="javascript:;" >';

                if (result.userLike) {
                    tmp += '<i class="iconfont icon-dianzan1"></i>';
                } else {
                    tmp += '<i class="iconfont icon-dianzan"></i>';
                }
                tmp += '<num>' + result.likes + '</num>' +
                    '</a>' +
                    '</li>' +
                    '<li class="comment" data-id="' + result.cid + '">' +
                    '<a href="javascript:;" ><i class="layui-icon">&#xe63a;</i>' +
                    '</a>' +
                    '</li>' +
                    '<li class="share" data-id="' + result.cid + '">' +
                    '<a href="javascript:;" ><i class="layui-icon">&#xe641;</i></a>' +
                    '</li>' +
                    '<li class="report" data-id="' + result.cid + '">' +
                    '<a href="javascript:;" ><i class="layui-icon">&#xe6c5;</i></a>' +
                    '</li>' +
                    '</ul>' +
                    '<div class="commentAll">' +
                    '<div class="reviewArea clearfix"></div>' +
                    '<div class="comment-show">';
                if (result.comment.length > 0) {
                    var child = buildReply(result.comment);
                    tmp += '<ul class="hf-list-con" style="display: block;">' + child + '</ul>';
                } else {
                    tmp += '<ul class="hf-list-con"></ul>';
                }
                tmp +=
                    '</div>' +
                    '</div>' +
                    '<div class="comment-pl-block clearfix">' +
                    '</div>' +
                    '</div>' +
                    '</div>' +
                    '</li>';
            }

        });
        $('div[data-id="topic"]').html(tmp);

    });
    $.get("/index/column", function (result) {

        $.each(result.data, function (idx, result) {
            $(`.topic-column a[data-name=${idx}]`).attr('href',"");
            $(`.topic-column a[data-name=${idx}] span`).text(result.topic);
        });

    });
    layui.use('layer', function () {
        let layer = layui.layer;
        let tips_idx;
        let pushLike = $('#push-like');
        let pushDisLike = $('#push-dislike');
        pushLike.mouseenter(function () {
            tips_idx = layer.tips('喜欢之后会给你推荐更多相似的哦', '#push-like', {
                tips: [1, '#FF8330']
            });
        });
        pushLike.mouseleave(function () {
            layer.close(tips_idx);
        });
        pushLike.on('click', function () {
            /*点击喜欢*/

        });
        pushDisLike.mouseenter(function () {
            tips_idx = layer.tips('不喜欢，换一条', '#push-dislike', {
                tips: [1, '#06799F']
            });
        });
        pushDisLike.mouseleave(function () {
            layer.close(tips_idx);
        });
        pushDisLike.on('click', function () {
            /*点击不喜欢*/

        });
    });
    $("#push-like").on("click", function () {
        $("div[data-id='user-like']").slideUp("normal");
        $("div[data-id='user-like']").slideDown("normal");
    });
    /*绑定回复按钮事件*/
    $();

</script>
<script type="text/javascript" src="js/nearby.js"></script>
</body>
</html>